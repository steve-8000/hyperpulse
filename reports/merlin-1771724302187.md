# Merlin 운영 리포트

- 생성 시각: 2026-02-22T01:38:22.187Z
- RSS: v2.0.4: Merge pull request #33 from MerlinLayer2/fix_rpc_bug
- 비교 기준(Base): cd29be667cd798e9f1f23d5dfb1b61d007b960a0
- 최신 커밋(Head): a5b68966824124ede4a3b2cfa90e88c85a8e595d

## 한줄 요약
이 릴리즈는 `v2.0.4` 버전으로, 주요 기능은 **getLogs** 버그 수정과 새로운 데이터 스트리머(데이터스트림) 기능 도입이다. RPC 인터페이스에는 직접적인 변경은 없으나, 테스트 스크립트와 CI 워크플로우에서 RPC 서비스 이름이 `cdk-erigon-node-001` → `cdk-erigon-rpc-001` 으로 바뀜. 이는 운영 환경에서 RPC 엔드포인트를 참조할 때 사용되는 이름이 바뀜야. 또한, `config.yml` 에서 몇몇 zkevm 관련 옵션이 삭제·추가되었으며, `disable-virtual-counters: true` 가 추가돼서 가상 카운터가 비활성화된다.

이 변경은 주로 테스트/CI 환경에 적용되었으나, 실제 운영 노드에서도 **데이터 스트리머**가 추가되어 저장소에 대한 부하를 늘릴 수 있다. 따라서 아카이브 노드(보관 정책/색인/스토리지)와 관련된 부분을 주의깊히 살펴야 한다.


**핵심 변경 포인트**
1. `getLogs` 버그 수정 (eth_getLogs 동작 개선)
2. 데이터 스트리머 모듈 추가(`cmd/datastreamer` 패키지)
3. `config.yml` 에서 zkevm 옵션 정리 및 비활성화 옵션 추가
4. 테스트 스크립트에서 RPC 서비스 이름 교체
5. CI 워크플로우에서 `da-mode` 옵션 제한 및 환경 변수 추가
6. `chainspec.json` 에서 여러 블록 타임스탬프를 0 으로 초기화

이상은 운영자 관점에서 주의깊히 검토해야 할 사항이다. 

## 운영자 중요 체크
- RPC/JSON-RPC 관련 변경 단서가 감지되었습니다.
- 외부 API 엔드포인트/버전 관련 변경 단서가 감지되었습니다.
- 아카이브 노드 운영(보관/색인/동기화) 관련 변경 단서가 감지되었습니다.
- 노드 설정값/프로토콜 플래그 관련 변경 단서가 감지되었습니다.

## 주요 변경점
- getLogs 버그 수정
- 데이터 스트리머 모듈 추가
- config.yml 옵션 정리 및 비활성화 옵션 추가

## RPC/API 영향
- 해당 사항 없음

## 아카이브 노드 영향
- 데이터 스트리머 도입으로 인한 스토리지 부하 증가(아카이브 노드)

## 운영 액션 아이템
- 1. 새 Docker 이미지(`cdk-erigon:local`) 빌드 후 배포 2. `config.yml` 에서 `zkevm.disable-virtual-counters: true` 를 적용 3. RPC 엔드포인트 이름이 `cdk-erigon-node-001` → `cdk-erigon-rpc-001` 으로 바뀜 것을 반영해 스크립트/환경 변수 업데이트 4. 데이터 스트리머 모듈이 추가되었으니, 스토리지 사용량을 모니터링 5. 테스트 환경에서 `getLogs` 동작이 정상인지 확인

## 마이그레이션 체크리스트
- 1. RPC 엔드포인트 이름 교체 반영 2. `disable-virtual-counters` 옵션 적용 여부 확인 3. 데이터 스트리머 모듈이 정상 동작하는지 테스트 4. `chainspec.json` 타임스탬프 0 으로 초기화가 실제 환경에 적합한지 검증 5. 아카이브 노드 스토리지 사용량 모니터링

## 위험/주의 사항
- 위험 요소 없음

## 근거(Evidence)
- commit a5b68966: Merge pull request #33 from MerlinLayer2/fix_rpc_bug commit 7899d9c4: fix getlogs bug commit 47142b88: Merge pull request #32 from MerlinLayer2/feature/fix_old_sequenceBatches commit 36cbfbbb: fix ci deb commit 96e51031: Merge pull request #29 from MerlinLayer2/feature/fix_ci commit 8fdc9852: add delay commit 31560155: fix ci bug commit 6ea99d7f: Merge pull request #25 from MerlinLayer2/feature/add_datastreamer commit fc555b3f: add datastreamer checker

## 운영 메모
- 추가 메모 없음

## 원문 커밋 내용
### Commit Log
```text
a5b68966 Merge pull request #33 from MerlinLayer2/fix_rpc_bug
7899d9c4 fix getlogs bug
47142b88 Merge pull request #32 from MerlinLayer2/feature/fix_old_sequenceBatches
977eab64 Merge pull request #31 from MerlinLayer2/feature/fix_ci
f5d397e2 fix ut small probability fail
1fae36b4 add old decoder
cff28f4a Merge pull request #30 from MerlinLayer2/feature/fix_ci
36cbfbbb fix ci deb
96e51031 Merge pull request #29 from MerlinLayer2/feature/fix_ci
8fdc9852 add delay
31560155 fix ci bug
6ea99d7f Merge pull request #25 from MerlinLayer2/feature/add_datastreamer
fc555b3f add datastreamer checker
```

