# Flow(Consensus) 운영 리포트

- 생성 시각: 2026-02-22T01:31:47.073Z
- RSS: v0.46.1-experimental-indexer.8
- 비교 기준(Base): 2db95a14348a45a1ce7d2c119be2bc42718cfd80
- 최신 커밋(Head): 1651c1aa13e6d0ddd0fb569b0296963d465bd475

## 한줄 요약
이 릴리즈는 Flow 노드에 **계정 거래**와 **토큰 전송(FT/NFT)** 정보를 조회할 수 있는 새로운 API를 추가하고, 기존 거래 인덱싱 로직을 개선한 버전이다.  API 인터페이스가 확장되면서 인덱서와 스토리지 레이어에 대한 변경이 포함되어 있다.  이는 노드 운영자에게 인덱싱 재구축, 스토리지 확장, API 버전 관리 등 여러 측면에서 주의가 필요하다.

## 운영자 중요 체크
- 외부 API 엔드포인트/버전 관련 변경 단서가 감지되었습니다.
- 아카이브 노드 운영(보관/색인/동기화) 관련 변경 단서가 감지되었습니다.
- 노드 설정값/프로토콜 플래그 관련 변경 단서가 감지되었습니다.

## 주요 변경점
- 1. API 인터페이스 확장: `GetAccountFungibleTokenTransfers`, `GetAccountNonFungibleTokenTransfers` 추가
- 2. 인덱서 구조 변경: `account_ft_transfers`, `account_nft_transfers` 파일 추가 및 테스트
- 3. 인덱싱 로직 개선: `storage.AccountTransactionsReader` → `ByAddress` 호출 방식 변경
- 4. 오류 매핑 로직 개선: `mapReadError` 사용으로 일관성 향상
- 5. 인덱서 부트스트래핑 로직 추가: `account_ft_transfers_bootstrapper.go`

## RPC/API 영향
- GetAccountFungibleTokenTransfers
- GetAccountNonFungibleTokenTransfers

## 아카이브 노드 영향
- 1. 인덱서가 비활성화된 경우 새 API 호출 시 `codes.NotFound` 반환
- 2. 인덱스 재구축 필요: `account_ft_transfers_bootstrapper.go` 와 `account_nft_transfers_bootstrapper.go` 를 포함한 인덱서가 필요
- 3. 스토리지 인터페이스 추가: `FungibleTokenTransfersBootstrapper`, `NonFungibleTokenTransfersBootstrapper`

## 운영 액션 아이템
- 1. 인덱스 초기화 플래그(`ftStore`, `nftStore`) 를 설정하고, 인덱스가 비활성화된 경우 재인덱싱을 트리거
- 2. 인덱스가 비활성화된 경우 `GetAccountFungibleTokenTransfers` / `GetAccountNonFungibleTokenTransfers` 호출 시 `codes.NotFound` 를 반환하도록 설정
- 3. 인덱스 재구축 시 로그/모니터링 지표를 추가

## 마이그레이션 체크리스트
- 1. 인덱스가 존재하는지 확인
- 2. 새 API 호출 시 파라미터 검증 로직이 정상 동작하는지 테스트
- 3. 인덱스 재구축 시 `account_ft_transfers_bootstrapper.go` 와 `account_nft_transfers_bootstrapper.go` 가 정상 동작하는지 검증
- 4. 스토리지 인터페이스가 구현되었는지 확인

## 위험/주의 사항
- 위험 요소 없음

## 근거(Evidence)
- commit 1651c1aa13: `GetAccountFungibleTokenTransfers` / `GetAccountNonFungibleTokenTransfers` 메서드 추가
- commit 1651c1aa13: `account_ft_transfers.go` / `account_nft_transfers.go` 파일 추가
- commit 1651c1aa13: `access/backends/extended/api.go` 에서 API 인터페이스 확장
- commit 1651c1aa13: `access/backends/extended/backend.go` 에서 인덱스 초기화 로직 추가
- commit 1651c1aa13: `access/backends/extended/backend_account_transactions.go` 에서 오류 매핑 로직 변경
- commit 1651c1aa13: `module/state_synchronization/indexer/extended/account_ft_transfers.go` 와 관련 테스트 파일 추가
- commit 1651c1aa13: `module/state_synchronization/indexer/extended/account_nft_transfers.go` 추가
- commit 1651c1aa13: `storage/indexes/account_ft_transfers.go` 와 `account_nft_transfers.go` 파일 추가

## 운영 메모
- 추가 메모 없음

## 원문 커밋 내용
### Commit Log
```text
1651c1aa13 use event slice instead of map
0277bc5492 add missing indexer test utils
0bb545104a update indexes storage to return ErrAlreadyExists for all already processed blocks
75aa715584 cleanup indexer tests
65cd95ca93 switch storage interfaces to use ByAddress
144317c87d improve error handling in the backend
54386a7a49 improve rest api testing
a4cfc55ea8 fix test errors
ebd0eef5eb Merge branch 'peter/account-transactions-api' into peter/account-transfers
eaf927d814 refactor and expand testing
7cc18b3989 Merge branch 'master' into peter/account-transactions-api
fbb308ec64 Merge pull request #8381 from onflow/peter/embedded-indexer
62ad26fee4 move exception handling first in indexNextHeights
8c4cb7baa0 Merge pull request #8418 from onflow/fxamacker/add-evm-wrapper-func
70b114521c Merge pull request #8422 from onflow/tim/run-go1.26-fix
6737724ed4 go fix: remove obsolete +build directives
c5a0b65000 Use geth crypto funcs to encode EVM call signature
f377af77b4 Merge pull request #8420 from onflow/jord/tag-lockctx
f11a22141b pin tagged version of lockctx
f4dfcdf635 Return raw result data if evm call fails
6fc4a4051f Remove a commented out line and fix existing nit
68fe55b2d3 Merge branch 'master' into fxamacker/add-evm-wrapper-func
2f7c74ed4b Merge branch 'peter/account-transactions-api' into peter/account-transfers
460d20bcfd Merge branch 'peter/account-transactions-api' into peter/account-transfers
3652635fb5 [Access] Add experimental account transfers rest API
aa36586ae0 Update test fixture
646eca3d27 Lint
f7f9e7b1e8 Add sanity check in encodeABIWithSigAndArgs
c7fb9df471 Lint
16120e2f7e Add 3 new EVM functions to optimize call and dryCall
```

